{"pageProps":{"entry":{"title":"日本語で国名を選択できて、値はISOの国コードになってるいい感じのセレクトボックスを5分でお手軽に用意する","slug":"2017/12/04/151158","excerpt":"国を選択させたいこと、ありますよね。\n\nセレクトボックスでは国名を表示させたいけど、値はISOの2桁国コードで保存したいってやつ。\n\nもちろん国名は日本語で。\n\nそんな状況がまた来たので、お手軽に5分で作れる方法を考えてみました。よければご活用ください。","content":"国を選択させたいこと、ありますよね。\n\nセレクトボックスでは国名を表示させたいけど、値はISOの2桁国コードで保存したいってやつ。\n\nもちろん国名は日本語で。\n\nそんな状況がまた来たので、お手軽に5分で作れる方法を考えてみました。よければご活用ください。経緯と方針\n-----\n\nこれ昔やってたときはRailsでgem入れたりしてたのです。\n\nしかし今回はRailsを離れて素のhtml/jsで書いてたので、どうしたもんかなーと思いまして。\n\n普通にライブラリとか探してたのですが、なかなかよさそうなのがない。\n\nで探しているとこんな記事を見つけました。\n\n[miz2403.com](http://miz2403.com/countries-list/)\n\nselectとoptionに国がずらっと入ってるやつが、テキストでコピペできるように用意されてます。\n\nなるほど、よく考えればこれで十分じゃないかと。\n\n国名なんてそうそうアップデートされるものでもないので、メンテナンス性はそんなに考慮しなくていいし。\n\n逆にライブラリとか使わない方がメンテナンスフリーで運用にはよさそうかもしれない。\n\nというわけで、ライブラリに頼らず生のHTML出力する方向ですすめてみます。\n\nさっきのリンクだと英語版しかないので、これの日本語版を用意するのがゴールです。\n\nやりかた\n----\n\nとにかく一回リストを作ってしまえばいいだけなので、いかに省力でいけるかがカギです。\n\n### Wikiの一覧ページをコピってスプレッドシードに貼り付ける\n\nまずは日本語の国名とISOコードが一覧になった元データを探します。\n\nWikipediaにいい感じのページがありました。\n\n[ISO 3166-1 - Wikipedia](https://ja.wikipedia.org/wiki/ISO_3166-1)\n\nこのテーブルの部分をまるっと選択してコピーして、スプレッドシートに貼り付けます。\n\nもちろんお好みでエクセルを使ってもかまいません。\n\n### CONCATENATE関数でoptionタグを生成\n\n次にこのデータから大量のoptionタグを生成します。\n\nやることはめちゃシンプルで、スプレッドシードのconcatenate（文字列結合）関数を使って、いい感じにタグを作るだけです。\n\nこんな感じ。\n\n![f:id:o_tomomichi:20171204144804p:plain](https://cdn-ak.f.st-hatena.com/images/fotolife/o/o_tomomichi/20171204/20171204144804.png \"f:id:o_tomomichi:20171204144804p:plain\")\n\nメインの部分は、\n\n`=CONCATENATE(\"<option value='\",LOWER(E3),\"'>\",A3,\"</option>\")`\n\nで、E列がISO2桁のコード、A列が日本語の国名ですね。\n\n今回はISOを小文字で使いたかったのでLOWER関数をかませてます。\n\nこの時点でもうほぼほぼできています。\n\n最後の仕上げとして、元のWikipediaのテーブルに値が入っていない見出し行があるため、これを除外するようにIF文を追加します。\n\n`=if(E3<>\"\", CONCATENATE(\"<option value='\",LOWER(E3),\"'>\",A3,\"</option>\"), \"\")`\n\nこれでいい感じにoptionタグが生成されました。\n\nあとはふつうにこれをコピペするだけで使えます。\n\n超お手軽！\n\n* * *\n\n英語名の列もあるので、英語版への切替も簡単にできそうです。\n\nおしまい。","date":1512367918000}},"__N_SSG":true}