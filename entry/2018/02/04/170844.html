<!DOCTYPE html><html lang="ja"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-30867542-2"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-30867542-2', {
              page_path: window.location.pathname,
            });
          </script><meta charSet="utf-8"/><meta content="width=device-width, initial-scale=1, minimum-scale=1" name="viewport"/><link rel="icon" href="/images/notsobad/favicon.ico"/><meta name="description" content="ぼっちスタートアップが日々がんばっています。"/><meta content="website" property="og:type"/><meta content="NOT SO BADなブログ" property="og:site_name"/><meta content="summary_large_image" name="twitter:card"/><title>Herokuの無料プランで月間100万PVをさばく（さばかない）話</title><meta content="Herokuの無料プランで月間100万PVをさばく（さばかない）話" property="og:title"/><meta content="https://notsobad.jp/blog/2018/02/04/170844" property="og:url"/><link rel="canonical" href="https://blog.notsobad.jp/2018/02/04/170844"/><meta content="https://storage.googleapis.com/blog-notsobad/images/20180204152944.png" property="og:image"/><meta content="https://storage.googleapis.com/blog-notsobad/images/20180204152944.png" name="twitter:image:src"/><meta content="

「Heroku Meetup #19 Heroku Trust!」でLTさせてもらってきました！

[herokujp.doorkeeper.jp](https://herokujp.doorkeeper.jp/events/69249)

せっかくなので、LTのスライドを一部修正して掲載しておきます。

Heroku Meetupはずっと行きたかったけど今まで都合がつかず、初参加できてよかったです。

ピザごちそうさまでした🍕" property="og:description"/><meta content="Herokuの無料プランで月間100万PVをさばく（さばかない）話" name="twitter:title"/><meta content="

「Heroku Meetup #19 Heroku Trust!」でLTさせてもらってきました！

[herokujp.doorkeeper.jp](https://herokujp.doorkeeper.jp/events/69249)

せっかくなので、LTのスライドを一部修正して掲載しておきます。

Heroku Meetupはずっと行きたかったけど今まで都合がつかず、初参加できてよかったです。

ピザごちそうさまでした🍕" name="twitter:description"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/2a61bf5a1a48ba5e812c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2a61bf5a1a48ba5e812c.css"/><link rel="preload" href="/_next/static/XW_9_1vdqNFxjGI43idhV/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/XW_9_1vdqNFxjGI43idhV/pages/entry/%5B...slug%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.4dd1003cc9c949c7fcd3.js" as="script"/><link rel="preload" href="/_next/static/chunks/79c7a5487e32dcfbbd86c68bca7313b05e8fcb4d.638a41a739461475fef6.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-5655d340547bb835631a.js" as="script"/><link rel="preload" href="/_next/static/chunks/05e7281cb7bcb49fe0351c4466dc8e68b797c2c9.df0200d1732db7c6b1bb.js" as="script"/><link rel="preload" href="/_next/static/chunks/c1225f9b9453dd52441b6f05b3391648cdc0d2c0.aba4705297cbae0d93ee.js" as="script"/></head><body><div id="__next"><div><section class="text-gray-700 body-font"><div class="container px-5 md:px-24 p-5 md:pb-12 mx-auto max-w-screen-lg"><h1 class="text-xl font-bold title-font text-gray-900 mb-4 inline-block border-b-4 border-gray-900"><a href="/blog">NOT SO BAD なブログ</a></h1><h2 class="text-xs text-gray-700 tracking-widest font-medium title-font">ぼっちスタートアップが日々がんばっています。</h2></div></section><section class="text-gray-700 body-font overflow-hidden break-all"><div class="container px-5 md:px-24 pb-24 mx-auto max-w-screen-lg"><div class="-my-8"><div class="py-12 flex flex-wrap md:flex-no-wrap"><div class="md:w-64 md:mb-0 mb-6 flex-shrink-0 flex flex-col"><span class="mt-1 text-gray-900 font-bold">2018-02-04</span></div><div class="flex-grow"><h2 class="text-2xl md:text-3xl font-bold text-gray-900 title-font mb-4">Herokuの無料プランで月間100万PVをさばく（さばかない）話</h2><img src="https://storage.googleapis.com/blog-notsobad/images/20180204152944.png" alt="Herokuの無料プランで月間100万PVをさばく（さばかない）話" class="mb-4"/><div id="mainText" class="leading-relaxed"><p class="my-6">「Heroku Meetup #19 Heroku Trust!」でLTさせてもらってきました！</p><p class="my-6"><a href="https://herokujp.doorkeeper.jp/events/69249" target="_blank" class="text-blue-600 underline">herokujp.doorkeeper.jp</a></p><p class="my-6">せっかくなので、LTのスライドを一部修正して掲載しておきます。</p><p class="my-6">Heroku Meetupはずっと行きたかったけど今まで都合がつかず、初参加できてよかったです。</p><h2 class="font-bold inline-block my-4 md:my-8 text-2xl">ピザごちそうさまでした🍕LT内容</h2><p class="my-6">というわけで発表したスライドはこちら。</p><p class="my-6"><a href="https://speakerdeck.com/tomomichi/herokufalsewu-liao-purandeyue-jian-100mo-pvwosabaku-sabakanai-hua" target="_blank" class="text-blue-600 underline">https://speakerdeck.com/tomomichi/herokufalsewu-liao-purandeyue-jian-100mo-pvwosabaku-sabakanai-hua</a></p><h2 class="font-bold inline-block my-4 md:my-8 text-2xl">3行で要約</h2><ul class="text-left list-disc ml-6"><li class="leading-8">それなりにアクセスが多いサイトでも、場合によってはHerokuのFreeDynoだけでさばけるよ</li><li class="leading-8">Herokuは更新系に集中して、アクセスが多い閲覧系のコンテンツはGoogleCloudStorage(GCS)とかS3に置いちゃえばいいんだよ</li><li class="leading-8">最近だとFastlyとか使うのがいいらしいけど、GCS/S3も安くて手軽にできるからおすすめだよ</li></ul><h2 class="font-bold inline-block my-4 md:my-8 text-2xl">補足とか言い訳とか</h2><p class="my-6">ちょうど発表の数日前に、似た内容の話がはてぶでバズってました。</p><p class="my-6"><a href="https://note.mu/konpyu/n/nb424a9a2ea8a" target="_blank" class="text-blue-600 underline">note.mu</a></p><p class="my-6">またさらに前に話題になった<a href="https://dev.to/" target="_blank" class="text-blue-600 underline">dev.to</a>もHeroku/Railsであの爆速を実現してて、その速さのコアな部分はFastlyによるCDN配信だったと理解しています。</p><p class="my-6">今回発表した内容も考え方はほぼ同じなんですが、Fastlyとかを使うんじゃなくてGCS使ってるところが違う点です。</p><p class="my-6">またメリット/デメリットの比較に関して、今回は配信速度の追求よりも、大量のアクセスをちゃんとさばくというところに重点を置いているため、その点もご了承ください。</p><p class="my-6">個人的にはdev.toの爆速っぷりに驚いた一人なので、今後Fastly（もしくは類似サービス）を使うのはもっと主流になっていくんじゃないかと思っています。</p><p class="my-6">ただ現時点でまだCDNでの動的コンテンツキャッシュをよく把握できておらず、自分の力量を考えると本番で試すのは怖いなーという感じです。</p><p class="my-6">あと金額的にもFastlyは多少高いのかなーと思っていて、個人のWebサービスなんかで使うにはまだハードルが高いという印象です。</p><p class="my-6">※そもそもFastly使ったことないので、違うよっていうご意見あればぜひ教えてほしいです。</p><p class="my-6">その点GCS方式は、ベストプラクティスではないかもしれないけど、わたし程度のエンジニアレベルで3年運用してて、お安くてトラブルもなく、今のところ超快適です。</p><p class="my-6">なので少なくとも現時点で、お手軽に試す分にはおすすめできるんじゃないかなーという話でした。</p><p class="my-6">ちなみに、LTのあと懇親会で色んな方に話しかけてもらったのですが、ちゃんとした開発会社さんからS3で似た仕組みを運用してるよ、という話を聞きました。</p><p class="my-6">4年前に試行錯誤してこのやり方にたどり着いたのですが、まぁ間違ってなかったんだなーと思えてうれしい限りです。</p><h2 class="font-bold inline-block my-4 md:my-8 text-2xl">まとめというか、余談</h2><p class="my-6">せっかくLTまでしたんですが、THE TOURNAMENTは現在、Rails/HerokuからFirebase/Riot.jsに絶賛リニューアル中です。</p><p class="my-6">しかしFirebaseにインフラが変わっても、このGCS方式の仕組み自体は続けています。</p><p class="my-6">いままでHTML出力は、Herokuのschedulerアドオンでバッチ処理していたのですが、CloudFunctionでFirestoreの更新をトリガーに動かすように変えたくらいですね。CloudFunction超便利。</p><p class="my-6">安定稼働してきたらFirebase版のやり方もまとめてみたいと思います。</p><h3 class="font-bold inline-block my-4 md:my-8 text-xl">余談の余談</h3><p class="my-6">Herokuからの移行を決めたのには色々理由があるのですが、Herokuがだめだからというわけではなく、作ってるサービスとの相性が大きいです。</p><p class="my-6">トーナメントだとデータ構造がほぼjsonで、フロントでうにょうにょ動かすのがメインになることを考えたときに、Heroku/Railsである必然性がなくてですね。。（気付くのが遅い）</p><p class="my-6">個人的にいまでもHerokuは大好きです。</p><p class="my-6">現状Herokuの無料プランでずっと動かせるのは1アプリだけなので、トーナメントの枠が空いたら、4年ぶりにHerokuで新しいアプリを動かせるのが楽しみだったりします。</p><p class="my-6">おしまい。</p><h5 class="font-bold inline-block my-4 md:my-8 text-lg">（2018年4月1日追記）</h5><p class="my-6">Firebaseへのお引っ越しが完了したので記事にまとめました。</p><p class="my-6"><a href="http://blog.notsobad.jp/entry/2018/03/31/132507" target="_blank" class="text-blue-600 underline">blog.notsobad.jp</a></p><p class="my-6">さようなら、Heroku。また会う日まで。。</p></div></div></div></div></div></section><footer class="text-gray-200 body-font"><div class="bg-gray-900"><div class="container mx-auto py-6 px-5 md:px-24 flex flex-wrap flex-col sm:flex-row max-w-screen-lg"><p class="text-gray-200 text-sm text-center sm:text-left"><a href="/blog" class="text-gray-500 hover:text-gray-200 ml-1" target="_blank">© 2020 NOT SO BADなブログ</a></p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"entry":{"title":"Herokuの無料プランで月間100万PVをさばく（さばかない）話","slug":"2018/02/04/170844","excerpt":"![f:id:o_tomomichi:20180204152944p:plain](https://cdn-ak.f.st-hatena.com/images/fotolife/o/o_tomomichi/20180204/20180204152944.png \"f:id:o_tomomichi:20180204152944p:plain\")\n\n「Heroku Meetup #19 Heroku Trust!」でLTさせてもらってきました！\n\n[herokujp.doorkeeper.jp](https://herokujp.doorkeeper.jp/events/69249)\n\nせっかくなので、LTのスライドを一部修正して掲載しておきます。\n\nHeroku Meetupはずっと行きたかったけど今まで都合がつかず、初参加できてよかったです。\n\nピザごちそうさまでした🍕","content":"![f:id:o_tomomichi:20180204152944p:plain](https://cdn-ak.f.st-hatena.com/images/fotolife/o/o_tomomichi/20180204/20180204152944.png \"f:id:o_tomomichi:20180204152944p:plain\")\n\n「Heroku Meetup #19 Heroku Trust!」でLTさせてもらってきました！\n\n[herokujp.doorkeeper.jp](https://herokujp.doorkeeper.jp/events/69249)\n\nせっかくなので、LTのスライドを一部修正して掲載しておきます。\n\nHeroku Meetupはずっと行きたかったけど今まで都合がつかず、初参加できてよかったです。\n\nピザごちそうさまでした🍕LT内容\n----\n\nというわけで発表したスライドはこちら。\n\n[https://speakerdeck.com/tomomichi/herokufalsewu-liao-purandeyue-jian-100mo-pvwosabaku-sabakanai-hua](https://speakerdeck.com/tomomichi/herokufalsewu-liao-purandeyue-jian-100mo-pvwosabaku-sabakanai-hua)\n\n3行で要約\n-----\n\n*   それなりにアクセスが多いサイトでも、場合によってはHerokuのFreeDynoだけでさばけるよ\n*   Herokuは更新系に集中して、アクセスが多い閲覧系のコンテンツはGoogleCloudStorage(GCS)とかS3に置いちゃえばいいんだよ\n*   最近だとFastlyとか使うのがいいらしいけど、GCS/S3も安くて手軽にできるからおすすめだよ\n\n補足とか言い訳とか\n---------\n\nちょうど発表の数日前に、似た内容の話がはてぶでバズってました。\n\n[note.mu](https://note.mu/konpyu/n/nb424a9a2ea8a)\n\nまたさらに前に話題になった[dev.to](https://dev.to/)もHeroku/Railsであの爆速を実現してて、その速さのコアな部分はFastlyによるCDN配信だったと理解しています。\n\n今回発表した内容も考え方はほぼ同じなんですが、Fastlyとかを使うんじゃなくてGCS使ってるところが違う点です。\n\nまたメリット/デメリットの比較に関して、今回は配信速度の追求よりも、大量のアクセスをちゃんとさばくというところに重点を置いているため、その点もご了承ください。\n\n個人的にはdev.toの爆速っぷりに驚いた一人なので、今後Fastly（もしくは類似サービス）を使うのはもっと主流になっていくんじゃないかと思っています。\n\nただ現時点でまだCDNでの動的コンテンツキャッシュをよく把握できておらず、自分の力量を考えると本番で試すのは怖いなーという感じです。\n\nあと金額的にもFastlyは多少高いのかなーと思っていて、個人のWebサービスなんかで使うにはまだハードルが高いという印象です。\n\n※そもそもFastly使ったことないので、違うよっていうご意見あればぜひ教えてほしいです。\n\nその点GCS方式は、ベストプラクティスではないかもしれないけど、わたし程度のエンジニアレベルで3年運用してて、お安くてトラブルもなく、今のところ超快適です。\n\nなので少なくとも現時点で、お手軽に試す分にはおすすめできるんじゃないかなーという話でした。\n\nちなみに、LTのあと懇親会で色んな方に話しかけてもらったのですが、ちゃんとした開発会社さんからS3で似た仕組みを運用してるよ、という話を聞きました。\n\n4年前に試行錯誤してこのやり方にたどり着いたのですが、まぁ間違ってなかったんだなーと思えてうれしい限りです。\n\nまとめというか、余談\n----------\n\nせっかくLTまでしたんですが、THE TOURNAMENTは現在、Rails/HerokuからFirebase/Riot.jsに絶賛リニューアル中です。\n\nしかしFirebaseにインフラが変わっても、このGCS方式の仕組み自体は続けています。\n\nいままでHTML出力は、Herokuのschedulerアドオンでバッチ処理していたのですが、CloudFunctionでFirestoreの更新をトリガーに動かすように変えたくらいですね。CloudFunction超便利。\n\n安定稼働してきたらFirebase版のやり方もまとめてみたいと思います。\n\n### 余談の余談\n\nHerokuからの移行を決めたのには色々理由があるのですが、Herokuがだめだからというわけではなく、作ってるサービスとの相性が大きいです。\n\nトーナメントだとデータ構造がほぼjsonで、フロントでうにょうにょ動かすのがメインになることを考えたときに、Heroku/Railsである必然性がなくてですね。。（気付くのが遅い）\n\n個人的にいまでもHerokuは大好きです。\n\n現状Herokuの無料プランでずっと動かせるのは1アプリだけなので、トーナメントの枠が空いたら、4年ぶりにHerokuで新しいアプリを動かせるのが楽しみだったりします。\n\nおしまい。\n\n##### （2018年4月1日追記）\n\nFirebaseへのお引っ越しが完了したので記事にまとめました。\n\n[blog.notsobad.jp](http://blog.notsobad.jp/entry/2018/03/31/132507)\n\nさようなら、Heroku。また会う日まで。。","date":1517731724000,"image":"https://storage.googleapis.com/blog-notsobad/images/20180204152944.png"}},"__N_SSG":true},"page":"/entry/[...slug]","query":{"slug":["2018","02","04","170844"]},"buildId":"XW_9_1vdqNFxjGI43idhV","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-f1eec38e83a82f41790c.js"></script><script async="" data-next-page="/_app" src="/_next/static/XW_9_1vdqNFxjGI43idhV/pages/_app.js"></script><script async="" data-next-page="/entry/[...slug]" src="/_next/static/XW_9_1vdqNFxjGI43idhV/pages/entry/%5B...slug%5D.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.4dd1003cc9c949c7fcd3.js" async=""></script><script src="/_next/static/chunks/79c7a5487e32dcfbbd86c68bca7313b05e8fcb4d.638a41a739461475fef6.js" async=""></script><script src="/_next/static/runtime/main-5655d340547bb835631a.js" async=""></script><script src="/_next/static/chunks/05e7281cb7bcb49fe0351c4466dc8e68b797c2c9.df0200d1732db7c6b1bb.js" async=""></script><script src="/_next/static/chunks/c1225f9b9453dd52441b6f05b3391648cdc0d2c0.aba4705297cbae0d93ee.js" async=""></script><script src="/_next/static/XW_9_1vdqNFxjGI43idhV/_buildManifest.js" async=""></script><script src="/_next/static/XW_9_1vdqNFxjGI43idhV/_ssgManifest.js" async=""></script></body></html>